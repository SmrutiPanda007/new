!function(n,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd&&define("GMaps",[],t);n.GMaps=t()}(this,function(){var r,s;if("object"!=typeof google||!window.google.maps)throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true.";var t=function(n,t){var i;if(n===t)return n;for(i in t)n[i]=t[i];return n},f=function(n,t){var i,u=Array.prototype.slice.call(arguments,2),r=[],f=n.length;if(Array.prototype.map&&n.map===Array.prototype.map)r=Array.prototype.map.call(n,function(n){return callback_params=u,callback_params.splice(0,0,n),t.apply(this,callback_params)});else for(i=0;f>i;i++)callback_params=u,callback_params.splice(0,0,n[i]),r.push(t.apply(this,callback_params));return r},o=function(n){for(var i=[],t=0;t<n.length;t++)i=i.concat(n[t]);return i},h=function(n,t){var i=n[0],r=n[1];return t&&(i=n[1],r=n[0]),new google.maps.LatLng(i,r)},u=function(n,t){for(var i=0;i<n.length;i++)n[i]=n[i].length>0&&"object"==typeof n[i][0]?u(n[i],t):h(n[i],t);return n},i=function(n,t){var n=n.replace("#","");return"jQuery"in this&&t?$("#"+n,t)[0]:document.getElementById(n)},c=function(n){var t=0,i=0;if(n.offsetParent)do t+=n.offsetLeft,i+=n.offsetTop;while(n=n.offsetParent);return[t,i]},n=function(){"use strict";var n=document,r=function(u){var w,b,o,s,v,y;if(!this)return new r(u);u.zoom=u.zoom||15;u.mapType=u.mapType||"roadmap";var f,e=this,h=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],l=["mousemove","mouseout","mouseover"],k=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],d=u.el||u.div,g=u.markerClusterer,it=google.maps.MapTypeId[u.mapType.toUpperCase()],rt=new google.maps.LatLng(u.lat,u.lng),ut=u.zoomControl||!0,nt=u.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},ft=nt.style||"DEFAULT",et=nt.position||"TOP_LEFT",ot=u.panControl||!0,st=u.mapTypeControl||!0,ht=u.scaleControl||!0,ct=u.streetViewControl||!0,tt=tt||!0,a={},p={zoom:this.zoom,center:rt,mapTypeId:it},lt={panControl:ot,zoomControl:ut,zoomControlOptions:{style:google.maps.ZoomControlStyle[ft],position:google.maps.ControlPosition[et]},mapTypeControl:st,scaleControl:ht,streetViewControl:ct,overviewMapControl:tt};if(this.el="string"==typeof u.el||"string"==typeof u.div?i(d,u.context):d,"undefined"==typeof this.el||null===this.el)throw"No element defined.";for(window.context_menu=window.context_menu||{},window.context_menu[e.el.id]={},this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=u.zoom,this.registered_events={},this.el.style.width=u.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=u.height||this.el.scrollHeight||this.el.offsetHeight,google.maps.visualRefresh=u.enableNewStyle,f=0;f<k.length;f++)delete u[k[f]];for(1!=u.disableDefaultUI&&(p=t(p,lt)),a=t(p,u),f=0;f<h.length;f++)delete a[h[f]];for(f=0;f<l.length;f++)delete a[l[f]];for(this.map=new google.maps.Map(this.el,a),g&&(this.markerClusterer=g.apply(this,[this.map])),w=function(n,t){var h="",f=window.context_menu[e.el.id][n],l,u,r,o,a,s,v;for(r in f)f.hasOwnProperty(r)&&(l=f[r],h+='<li><a id="'+n+"_"+r+'" href="#">'+l.title+"<\/a><\/li>");if(i("gmaps_context_menu")){for(u=i("gmaps_context_menu"),u.innerHTML=h,o=u.getElementsByTagName("a"),a=o.length,r=0;a>r;r++)s=o[r],v=function(i){i.preventDefault();f[this.id.replace(n+"_","")].action.apply(e,[t]);e.hideContextMenu()},google.maps.event.clearListeners(s,"click"),google.maps.event.addDomListenerOnce(s,"click",v,!1);var y=c.apply(this,[e.el]),p=y[0]+t.pixel.x-15,w=y[1]+t.pixel.y-15;u.style.left=p+"px";u.style.top=w+"px";u.style.display="block"}},this.buildContextMenu=function(n,t){if("marker"===n){t.pixel={};var i=new google.maps.OverlayView;i.setMap(e.map);i.draw=function(){var r=i.getProjection(),u=t.marker.getPosition();t.pixel=r.fromLatLngToContainerPixel(u);w(n,t)}}else w(n,t)},this.setContextMenu=function(t){var f,r,u,o;window.context_menu[e.el.id][t.control]={};r=n.createElement("ul");for(f in t.options)t.options.hasOwnProperty(f)&&(u=t.options[f],window.context_menu[e.el.id][t.control][u.name]={title:u.title,action:u.action});r.id="gmaps_context_menu";r.style.display="none";r.style.position="absolute";r.style.minWidth="100px";r.style.background="white";r.style.listStyle="none";r.style.padding="8px";r.style.boxShadow="2px 2px 6px #ccc";n.body.appendChild(r);o=i("gmaps_context_menu");google.maps.event.addDomListener(o,"mouseout",function(n){n.relatedTarget&&this.contains(n.relatedTarget)||window.setTimeout(function(){o.style.display="none"},400)},!1)},this.hideContextMenu=function(){var n=i("gmaps_context_menu");n&&(n.style.display="none")},b=function(n,t){google.maps.event.addListener(n,t,function(n){void 0==n&&(n=this);u[t].apply(this,[n]);e.hideContextMenu()})},o=0;o<h.length;o++)s=h[o],s in u&&b(this.map,s);for(o=0;o<l.length;o++)s=l[o],s in u&&b(this.map,s);google.maps.event.addListener(this.map,"rightclick",function(n){u.rightclick&&u.rightclick.apply(this,[n]);void 0!=window.context_menu[e.el.id].map&&e.buildContextMenu("map",n)});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){for(var t=[],i=this.markers.length,n=0;i>n;n++)"boolean"==typeof this.markers[n].visible&&this.markers[n].visible&&t.push(this.markers[n].getPosition());this.fitLatLngBounds(t)};this.fitLatLngBounds=function(n){for(var r=n.length,i=new google.maps.LatLngBounds,t=0;r>t;t++)i.extend(n[t]);this.map.fitBounds(i)};this.setCenter=function(n,t,i){this.map.panTo(new google.maps.LatLng(n,t));i&&i()};this.getElement=function(){return this.el};this.zoomIn=function(n){n=n||1;this.zoom=this.map.getZoom()+n;this.map.setZoom(this.zoom)};this.zoomOut=function(n){n=n||1;this.zoom=this.map.getZoom()-n;this.map.setZoom(this.zoom)};y=[];for(v in this.map)"function"!=typeof this.map[v]||this[v]||y.push(v);for(f=0;f<y.length;f++)!function(n,t,i){n[i]=function(){return t[i].apply(t,arguments)}}(this,this.map,y[f])};return r}(this);return n.prototype.createControl=function(n){var t=document.createElement("div"),i,r;t.style.cursor="pointer";n.disableDefaultStyles!==!0&&(t.style.fontFamily="Roboto, Arial, sans-serif",t.style.fontSize="11px",t.style.boxShadow="rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px");for(i in n.style)t.style[i]=n.style[i];n.id&&(t.id=n.id);n.classes&&(t.className=n.classes);n.content&&(t.innerHTML=n.content);for(r in n.events)!function(t,i){google.maps.event.addDomListener(t,i,function(){n.events[i].apply(this,[this])})}(t,r);return t.index=1,t},n.prototype.addControl=function(n){var i=google.maps.ControlPosition[n.position.toUpperCase()],t;return delete n.position,t=this.createControl(n),this.controls.push(t),this.map.controls[i].push(t),t},n.prototype.createMarker=function(n){var i,e,r;if(void 0==n.lat&&void 0==n.lng&&void 0==n.position)throw"No latitude or longitude defined.";var u=this,h=n.details,c=n.fences,l=n.outside,a={position:new google.maps.LatLng(n.lat,n.lng),map:null},f=t(a,n);if(delete f.lat,delete f.lng,delete f.fences,delete f.outside,i=new google.maps.Marker(f),i.fences=c,n.infoWindow)for(i.infoWindow=new google.maps.InfoWindow(n.infoWindow),e=["closeclick","content_changed","domready","position_changed","zindex_changed"],r=0;r<e.length;r++)!function(t,i){n.infoWindow[i]&&google.maps.event.addListener(t,i,function(t){n.infoWindow[i].apply(this,[t])})}(i.infoWindow,e[r]);for(var o=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],s=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],r=0;r<o.length;r++)!function(t,i){n[i]&&google.maps.event.addListener(t,i,function(){n[i].apply(this,[this])})}(i,o[r]);for(r=0;r<s.length;r++)!function(t,i,r){n[r]&&google.maps.event.addListener(i,r,function(i){i.pixel||(i.pixel=t.getProjection().fromLatLngToPoint(i.latLng));n[r].apply(this,[i])})}(this.map,i,s[r]);return google.maps.event.addListener(i,"click",function(){this.details=h;n.click&&n.click.apply(this,[this]);i.infoWindow&&(u.hideInfoWindows(),i.infoWindow.open(u.map,i))}),google.maps.event.addListener(i,"rightclick",function(t){t.marker=this;n.rightclick&&n.rightclick.apply(this,[t]);void 0!=window.context_menu[u.el.id].marker&&u.buildContextMenu("marker",t)}),i.fences&&google.maps.event.addListener(i,"dragend",function(){u.checkMarkerGeofence(i,function(n,t){l(n,t)})}),i},n.prototype.addMarker=function(t){var i;if(t.hasOwnProperty("gm_accessors_"))i=t;else{if(!(t.hasOwnProperty("lat")&&t.hasOwnProperty("lng")||t.position))throw"No latitude or longitude defined.";i=this.createMarker(t)}return i.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(i),this.markers.push(i),n.fire("marker_added",i,this),i},n.prototype.addMarkers=function(n){for(var t,i=0;t=n[i];i++)this.addMarker(t);return this.markers},n.prototype.hideInfoWindows=function(){for(var n,t=0;n=this.markers[t];t++)n.infoWindow&&n.infoWindow.close()},n.prototype.removeMarker=function(t){for(var i=0;i<this.markers.length;i++)if(this.markers[i]===t){this.markers[i].setMap(null);this.markers.splice(i,1);this.markerClusterer&&this.markerClusterer.removeMarker(t);n.fire("marker_removed",t,this);break}return t},n.prototype.removeMarkers=function(n){var i=[],t;if("undefined"==typeof n){for(t=0;t<this.markers.length;t++)this.markers[t].setMap(null);this.markers=i}else{for(t=0;t<n.length;t++)this.markers.indexOf(n[t])>-1&&this.markers[t].setMap(null);for(t=0;t<this.markers.length;t++)null!=this.markers[t].getMap()&&i.push(this.markers[t]);this.markers=i}},n.prototype.drawOverlay=function(n){var t=new google.maps.OverlayView,i=!0;return t.setMap(this.map),null!=n.auto_show&&(i=n.auto_show),t.onAdd=function(){var i=document.createElement("div"),r;i.style.borderStyle="none";i.style.borderWidth="0px";i.style.position="absolute";i.style.zIndex=100;i.innerHTML=n.content;t.el=i;n.layer||(n.layer="overlayLayer");var f=this.getPanes(),e=f[n.layer],u=["contextmenu","DOMMouseScroll","dblclick","mousedown"];for(e.appendChild(i),r=0;r<u.length;r++)!function(n,t){google.maps.event.addDomListener(n,t,function(n){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&document.all?(n.cancelBubble=!0,n.returnValue=!1):n.stopPropagation()})}(i,u[r]);google.maps.event.trigger(this,"ready")},t.draw=function(){var s=this.getProjection(),u=s.fromLatLngToDivPixel(new google.maps.LatLng(n.lat,n.lng));n.horizontalOffset=n.horizontalOffset||0;n.verticalOffset=n.verticalOffset||0;var r=t.el,f=r.children[0],e=f.clientHeight,o=f.clientWidth;switch(n.verticalAlign){case"top":r.style.top=u.y-e+n.verticalOffset+"px";break;default:case"middle":r.style.top=u.y-e/2+n.verticalOffset+"px";break;case"bottom":r.style.top=u.y+n.verticalOffset+"px"}switch(n.horizontalAlign){case"left":r.style.left=u.x-o+n.horizontalOffset+"px";break;default:case"center":r.style.left=u.x-o/2+n.horizontalOffset+"px";break;case"right":r.style.left=u.x+n.horizontalOffset+"px"}r.style.display=i?"block":"none";i||n.show.apply(this,[r])},t.onRemove=function(){var i=t.el;n.remove?n.remove.apply(this,[i]):(t.el.parentNode.removeChild(t.el),t.el=null)},this.overlays.push(t),t},n.prototype.removeOverlay=function(n){for(var t=0;t<this.overlays.length;t++)if(this.overlays[t]===n){this.overlays[t].setMap(null);this.overlays.splice(t,1);break}},n.prototype.removeOverlays=function(){for(var n,t=0;n=this.overlays[t];t++)n.setMap(null);this.overlays=[]},n.prototype.drawPolyline=function(t){var f=[],r=t.path,e,o,i;if(r.length)if(void 0===r[0][0])f=r;else for(o=0;e=r[o];o++)f.push(new google.maps.LatLng(e[0],e[1]));i={map:this.map,path:f,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWeight:t.strokeWeight,geodesic:t.geodesic,clickable:!0,editable:!1,visible:!0};t.hasOwnProperty("clickable")&&(i.clickable=t.clickable);t.hasOwnProperty("editable")&&(i.editable=t.editable);t.hasOwnProperty("icons")&&(i.icons=t.icons);t.hasOwnProperty("zIndex")&&(i.zIndex=t.zIndex);for(var u=new google.maps.Polyline(i),h=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],s=0;s<h.length;s++)!function(n,i){t[i]&&google.maps.event.addListener(n,i,function(n){t[i].apply(this,[n])})}(u,h[s]);return this.polylines.push(u),n.fire("polyline_added",u,this),u},n.prototype.removePolyline=function(t){for(var i=0;i<this.polylines.length;i++)if(this.polylines[i]===t){this.polylines[i].setMap(null);this.polylines.splice(i,1);n.fire("polyline_removed",t,this);break}},n.prototype.removePolylines=function(){for(var n,t=0;n=this.polylines[t];t++)n.setMap(null);this.polylines=[]},n.prototype.drawCircle=function(n){n=t({map:this.map,center:new google.maps.LatLng(n.lat,n.lng)},n);delete n.lat;delete n.lng;for(var i=new google.maps.Circle(n),u=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],r=0;r<u.length;r++)!function(t,i){n[i]&&google.maps.event.addListener(t,i,function(t){n[i].apply(this,[t])})}(i,u[r]);return this.polygons.push(i),i},n.prototype.drawRectangle=function(n){var u;n=t({map:this.map},n);u=new google.maps.LatLngBounds(new google.maps.LatLng(n.bounds[0][0],n.bounds[0][1]),new google.maps.LatLng(n.bounds[1][0],n.bounds[1][1]));n.bounds=u;for(var i=new google.maps.Rectangle(n),f=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],r=0;r<f.length;r++)!function(t,i){n[i]&&google.maps.event.addListener(t,i,function(t){n[i].apply(this,[t])})}(i,f[r]);return this.polygons.push(i),i},n.prototype.drawPolygon=function(i){var e=!1;i.hasOwnProperty("useGeoJSON")&&(e=i.useGeoJSON);delete i.useGeoJSON;i=t({map:this.map},i);0==e&&(i.paths=[i.paths.slice(0)]);i.paths.length>0&&i.paths[0].length>0&&(i.paths=o(f(i.paths,u,e)));for(var r=new google.maps.Polygon(i),h=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],s=0;s<h.length;s++)!function(n,t){i[t]&&google.maps.event.addListener(n,t,function(n){i[t].apply(this,[n])})}(r,h[s]);return this.polygons.push(r),n.fire("polygon_added",r,this),r},n.prototype.removePolygon=function(t){for(var i=0;i<this.polygons.length;i++)if(this.polygons[i]===t){this.polygons[i].setMap(null);this.polygons.splice(i,1);n.fire("polygon_removed",t,this);break}},n.prototype.removePolygons=function(){for(var n,t=0;n=this.polygons[t];t++)n.setMap(null);this.polygons=[]},n.prototype.getFromFusionTables=function(n){var i=n.events,r,t,u;delete n.events;r=n;t=new google.maps.FusionTablesLayer(r);for(u in i)!function(n,t){google.maps.event.addListener(n,t,function(n){i[t].apply(this,[n])})}(t,u);return this.layers.push(t),t},n.prototype.loadFromFusionTables=function(n){var t=this.getFromFusionTables(n);return t.setMap(this.map),t},n.prototype.getFromKML=function(n){var f=n.url,i=n.events,r,t,u;delete n.url;delete n.events;r=n;t=new google.maps.KmlLayer(f,r);for(u in i)!function(n,t){google.maps.event.addListener(n,t,function(n){i[t].apply(this,[n])})}(t,u);return this.layers.push(t),t},n.prototype.loadFromKML=function(n){var t=this.getFromKML(n);return t.setMap(this.map),t},n.prototype.addLayer=function(n,t){var i,r,u;t=t||{};switch(n){case"weather":this.singleLayers.weather=i=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=i=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=i=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=i=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=i=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=i=new google.maps.panoramio.PanoramioLayer;i.setTag(t.filter);delete t.filter;t.click&&google.maps.event.addListener(i,"click",function(n){t.click(n);delete t.click});break;case"places":(this.singleLayers.places=i=new google.maps.places.PlacesService(this.map),t.search||t.nearbySearch||t.radarSearch)&&(r={bounds:t.bounds||null,keyword:t.keyword||null,location:t.location||null,name:t.name||null,radius:t.radius||null,rankBy:t.rankBy||null,types:t.types||null},t.radarSearch&&i.radarSearch(r,t.radarSearch),t.search&&i.search(r,t.search),t.nearbySearch&&i.nearbySearch(r,t.nearbySearch));t.textSearch&&(u={bounds:t.bounds||null,location:t.location||null,query:t.query||null,radius:t.radius||null},i.textSearch(u,t.textSearch))}if(void 0!==i)return("function"==typeof i.setOptions&&i.setOptions(t),"function"==typeof i.setMap&&i.setMap(this.map),i)},n.prototype.removeLayer=function(n){if("string"==typeof n&&void 0!==this.singleLayers[n])this.singleLayers[n].setMap(null),delete this.singleLayers[n];else for(var t=0;t<this.layers.length;t++)if(this.layers[t]===n){this.layers[t].setMap(null);this.layers.splice(t,1);break}},n.prototype.getRoutes=function(n){var f,i,u,e;switch(n.travelMode){case"bicycling":r=google.maps.TravelMode.BICYCLING;break;case"transit":r=google.maps.TravelMode.TRANSIT;break;case"driving":r=google.maps.TravelMode.DRIVING;break;default:r=google.maps.TravelMode.WALKING}s="imperial"===n.unitSystem?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;f={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]};i=t(f,n);i.origin=/string/.test(typeof n.origin)?n.origin:new google.maps.LatLng(n.origin[0],n.origin[1]);i.destination=/string/.test(typeof n.destination)?n.destination:new google.maps.LatLng(n.destination[0],n.destination[1]);i.travelMode=r;i.unitSystem=s;delete i.callback;delete i.error;u=this;e=new google.maps.DirectionsService;e.route(i,function(t,i){if(i===google.maps.DirectionsStatus.OK){for(var r in t.routes)t.routes.hasOwnProperty(r)&&u.routes.push(t.routes[r]);n.callback&&n.callback(u.routes)}else n.error&&n.error(t,i)})},n.prototype.removeRoutes=function(){this.routes=[]},n.prototype.getElevations=function(n){var i,r,e;n=t({locations:[],path:!1,samples:256},n);n.locations.length>0&&n.locations[0].length>0&&(n.locations=o(f([n.locations],u,!1)));i=n.callback;delete n.callback;r=new google.maps.ElevationService;n.path?(e={path:n.locations,samples:n.samples},r.getElevationAlongPath(e,function(n,t){i&&"function"==typeof i&&i(n,t)})):(delete n.path,delete n.samples,r.getElevationForLocations(n,function(n,t){i&&"function"==typeof i&&i(n,t)}))},n.prototype.cleanRoute=n.prototype.removePolylines,n.prototype.drawRoute=function(n){var t=this;this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,unitSystem:n.unitSystem,error:n.error,callback:function(i){i.length>0&&(t.drawPolyline({path:i[i.length-1].overview_path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.callback&&n.callback(i[i.length-1]))}})},n.prototype.travelRoute=function(n){if(n.origin&&n.destination)this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,error:n.error,callback:function(t){var i,u,f,r;if((t.length>0&&n.start&&n.start(t[t.length-1]),t.length>0&&n.step)&&(i=t[t.length-1],i.legs.length>0))for(f=i.legs[0].steps,r=0;u=f[r];r++)u.step_number=r,n.step(u,i.legs[0].steps.length-1);t.length>0&&n.end&&n.end(t[t.length-1])}});else if(n.route&&n.route.legs.length>0)for(var t,r=n.route.legs[0].steps,i=0;t=r[i];i++)t.step_number=i,n.step(t)},n.prototype.drawSteppedRoute=function(n){var r=this,t,u,i;if(n.origin&&n.destination)this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,error:n.error,callback:function(t){var i,u,e,f;if((t.length>0&&n.start&&n.start(t[t.length-1]),t.length>0&&n.step)&&(i=t[t.length-1],i.legs.length>0))for(e=i.legs[0].steps,f=0;u=e[f];f++)u.step_number=f,r.drawPolyline({path:u.path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.step(u,i.legs[0].steps.length-1);t.length>0&&n.end&&n.end(t[t.length-1])}});else if(n.route&&n.route.legs.length>0)for(u=n.route.legs[0].steps,i=0;t=u[i];i++)t.step_number=i,r.drawPolyline({path:t.path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.step(t)},n.Route=function(n){this.origin=n.origin;this.destination=n.destination;this.waypoints=n.waypoints;this.map=n.map;this.route=n.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}).getPath()},n.Route.prototype.getRoute=function(n){var t=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:n.travelMode,waypoints:this.waypoints||[],error:n.error,callback:function(){t.route=e[0];n.callback&&n.callback.call(t)}})},n.Route.prototype.back=function(){var n,t;if(this.step_count>0){this.step_count--;n=this.route.legs[0].steps[this.step_count].path;for(t in n)n.hasOwnProperty(t)&&this.polyline.pop()}},n.Route.prototype.forward=function(){var n,t;if(this.step_count<this.steps_length){n=this.route.legs[0].steps[this.step_count].path;for(t in n)n.hasOwnProperty(t)&&this.polyline.push(n[t]);this.step_count++}},n.prototype.checkGeofence=function(n,t,i){return i.containsLatLng(new google.maps.LatLng(n,t))},n.prototype.checkMarkerGeofence=function(n,t){var i,r,u;if(n.fences)for(r=0;i=n.fences[r];r++)u=n.getPosition(),this.checkGeofence(u.lat(),u.lng(),i)||t(n,i)},n.prototype.toImage=function(t){var t=t||{},i={},r,u;if(i.size=t.size||[this.el.clientWidth,this.el.clientHeight],i.lat=this.getCenter().lat(),i.lng=this.getCenter().lng(),this.markers.length>0)for(i.markers=[],r=0;r<this.markers.length;r++)i.markers.push({lat:this.markers[r].getPosition().lat(),lng:this.markers[r].getPosition().lng()});return this.polylines.length>0&&(u=this.polylines[0],i.polyline={},i.polyline.path=google.maps.geometry.encoding.encodePath(u.getPath()),i.polyline.strokeColor=u.strokeColor,i.polyline.strokeOpacity=u.strokeOpacity,i.polyline.strokeWeight=u.strokeWeight),n.staticMapURL(i)},n.staticMapURL=function(n){function k(n,t){if("#"===n[0]&&(n=n.replace("#","0x"),t)){if(t=parseFloat(t),t=Math.min(1,Math.max(t,0)),0===t)return"0x00000000";t=(255*t).toString(16);1===t.length&&(t+=t);n=n.slice(0,8)+t}return n}var t,i=[],p="http://maps.googleapis.com/maps/api/staticmap",c,f,e,d,h,g,u,w,o,r,l,a,v,b,nt,tt,y,it,s,rt;n.url&&(p=n.url,delete n.url);p+="?";c=n.markers;delete n.markers;!c&&n.marker&&(c=[n.marker],delete n.marker);f=n.styles;delete n.styles;e=n.polyline;(delete n.polyline,n.center)?(i.push("center="+n.center),delete n.center):n.address?(i.push("center="+n.address),delete n.address):n.lat?(i.push(["center=",n.lat,",",n.lng].join("")),delete n.lat,delete n.lng):n.visible&&(d=encodeURI(n.visible.join("|")),i.push("visible="+d));h=n.size;h?(h.join&&(h=h.join("x")),delete n.size):h="630x300";i.push("size="+h);n.zoom||n.zoom===!1||(n.zoom=15);g=n.hasOwnProperty("sensor")?!!n.sensor:!0;delete n.sensor;i.push("sensor="+g);for(o in n)n.hasOwnProperty(o)&&i.push(o+"="+n[o]);if(c)for(r=0;t=c[r];r++){u=[];t.size&&"normal"!==t.size?(u.push("size:"+t.size),delete t.size):t.icon&&(u.push("icon:"+encodeURI(t.icon)),delete t.icon);t.color&&(u.push("color:"+t.color.replace("#","0x")),delete t.color);t.label&&(u.push("label:"+t.label[0].toUpperCase()),delete t.label);w=t.address?t.address:t.lat+","+t.lng;delete t.address;delete t.lat;delete t.lng;for(o in t)t.hasOwnProperty(o)&&u.push(o+":"+t[o]);u.length||0===r?(u.push(w),u=u.join("|"),i.push("markers="+encodeURI(u))):(u=i.pop()+encodeURI("|"+w),i.push(u))}if(f)for(r=0;r<f.length;r++){for(l=[],f[r].featureType&&"all"!=f[r].featureType&&l.push("feature:"+f[r].featureType),f[r].elementType&&"all"!=f[r].elementType&&l.push("element:"+f[r].elementType),s=0;s<f[r].stylers.length;s++)for(a in f[r].stylers[s])v=f[r].stylers[s][a],("hue"==a||"color"==a)&&(v="0x"+v.substring(1)),l.push(a+":"+v);b=l.join("|");""!=b&&i.push("style="+b)}if(e){if((t=e,e=[],t.strokeWeight&&e.push("weight:"+parseInt(t.strokeWeight,10)),t.strokeColor)&&(nt=k(t.strokeColor,t.strokeOpacity),e.push("color:"+nt)),t.fillColor&&(tt=k(t.fillColor,t.fillOpacity),e.push("fillcolor:"+tt)),y=t.path,y.join)for(s=0;it=y[s];s++)e.push(it.join(","));else e.push("enc:"+y);e=e.join("|");i.push("path="+encodeURI(e))}return rt=window.devicePixelRatio||1,i.push("scale="+rt),i=i.join("&"),p+i},n.prototype.addMapType=function(n,t){if(!t.hasOwnProperty("getTileUrl")||"function"!=typeof t.getTileUrl)throw"'getTileUrl' function required.";t.tileSize=t.tileSize||new google.maps.Size(256,256);var i=new google.maps.ImageMapType(t);this.map.mapTypes.set(n,i)},n.prototype.addOverlayMapType=function(n){if(!n.hasOwnProperty("getTile")||"function"!=typeof n.getTile)throw"'getTile' function required.";var t=n.index;delete n.index;this.map.overlayMapTypes.insertAt(t,n)},n.prototype.removeOverlayMapType=function(n){this.map.overlayMapTypes.removeAt(n)},n.prototype.addStyle=function(n){var t=new google.maps.StyledMapType(n.styles,{name:n.styledMapName});this.map.mapTypes.set(n.mapTypeId,t)},n.prototype.setStyle=function(n){this.map.setMapTypeId(n)},n.prototype.createPanorama=function(t){return t.hasOwnProperty("lat")&&t.hasOwnProperty("lng")||(t.lat=this.getCenter().lat(),t.lng=this.getCenter().lng()),this.panorama=n.createPanorama(t),this.map.setStreetView(this.panorama),this.panorama},n.createPanorama=function(n){var o=i(n.el,n.context),f,r;n.position=new google.maps.LatLng(n.lat,n.lng);delete n.el;delete n.context;delete n.lat;delete n.lng;for(var u=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],e=t({visible:!0},n),r=0;r<u.length;r++)delete e[u[r]];for(f=new google.maps.StreetViewPanorama(o,e),r=0;r<u.length;r++)!function(t,i){n[i]&&google.maps.event.addListener(t,i,function(){n[i].apply(this)})}(f,u[r]);return f},n.prototype.on=function(t,i){return n.on(t,this,i)},n.prototype.off=function(t){n.off(t,this)},n.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"],n.on=function(t,i,r){if(-1==n.custom_events.indexOf(t))return google.maps.event.addListener(i,t,r);var u={handler:r,eventName:t};return i.registered_events[t]=i.registered_events[t]||[],i.registered_events[t].push(u),u},n.off=function(t,i){-1==n.custom_events.indexOf(t)?google.maps.event.clearListeners(i,t):i.registered_events[t]=[]},n.fire=function(t,i,r){if(-1==n.custom_events.indexOf(t))google.maps.event.trigger(i,t,Array.prototype.slice.apply(arguments).slice(2));else if(t in r.registered_events)for(var f=r.registered_events[t],u=0;u<f.length;u++)!function(n,t,i){n.apply(t,[i])}(f[u].handler,r,i)},n.geolocate=function(n){var t=n.always||n.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(i){n.success(i);t&&t()},function(i){n.error(i);t&&t()},n.options):(n.not_supported(),t&&t())},n.geocode=function(n){this.geocoder=new google.maps.Geocoder;var t=n.callback;n.hasOwnProperty("lat")&&n.hasOwnProperty("lng")&&(n.latLng=new google.maps.LatLng(n.lat,n.lng));delete n.lat;delete n.lng;delete n.callback;this.geocoder.geocode(n,function(n,i){t(n,i)})},google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(){for(var n,t,r=new google.maps.LatLngBounds,u=this.getPaths(),i=0;i<u.getLength();i++)for(t=u.getAt(i),n=0;n<t.getLength();n++)r.extend(t.getAt(n));return r}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(n){var o=this.getBounds(),t,i;if(null!==o&&!o.contains(n))return!1;for(var u=!1,c=this.getPaths().getLength(),f=0;c>f;f++)for(var e=this.getPaths().getAt(f),s=e.getLength(),h=s-1,r=0;s>r;r++)t=e.getAt(r),i=e.getAt(h),(t.lng()<n.lng()&&i.lng()>=n.lng()||i.lng()<n.lng()&&t.lng()>=n.lng())&&t.lat()+(n.lng()-t.lng())/(i.lng()-t.lng())*(i.lat()-t.lat())<n.lat()&&(u=!u),h=r;return u}),google.maps.LatLngBounds.prototype.containsLatLng=function(n){return this.contains(n)},google.maps.Marker.prototype.setFences=function(n){this.fences=n},google.maps.Marker.prototype.addFence=function(n){this.fences.push(n)},google.maps.Marker.prototype.getId=function(){return this.__gm_id},Array.prototype.indexOf||(Array.prototype.indexOf=function(n){"use strict";var u,r,t,i;if(null==this)throw new TypeError;if((u=Object(this),r=u.length>>>0,0===r)||(t=0,arguments.length>1&&(t=Number(arguments[1]),t!=t?t=0:0!=t&&1/0!=t&&t!=-1/0&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=r))return-1;for(i=t>=0?t:Math.max(r-Math.abs(t),0);r>i;i++)if(i in u&&u[i]===n)return i;return-1}),n})